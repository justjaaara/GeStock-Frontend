<div class="grid">
    <app-stat-card title="Ordenes Activas" [value]="14" badge="‚Üë 3 meses" tone="good" />
    <app-stat-card title="Pendientes Aprobacion" [value]="5" badge="‚åõRevisar " />
    <app-stat-card title="Valor total mes" [value]="'$28,450'" badge="‚Üë 18%" tone="good" />
    <app-stat-card title="Recibidas mes" [value]="12" badge="‚Üë En tiempo" tone="good" />
</div>

<section class="panel">
    <header class="panel-header">
        <h4>Historial de Movimientos</h4>

        <!-- Filtros -->
        <div class="controls">
            <div class="field">
                <label>Desde</label>
                <input type="text" placeholder="mm/dd/yyyy">
            </div>
            <div class="field">
                <label>Hasta</label>
                <input type="text" placeholder="mm/dd/yyyy">
            </div>
            <div class="field">
                <label>Tipo</label>
                <select>
                    <option>Todos</option>
                    <option>Entrada</option>
                    <option>Salida</option>
                </select>
            </div>
            <div class="field">
                <label>Estatus</label>
                <select>
                    <option>Vigente</option>
                    <option>Anulado</option>
                </select>
            </div>
            <div class="field">
                <label>&nbsp;</label>
                <button class="btn primary">Filtrar</button>
            </div>
        </div>
    </header>

    <!-- Tabla -->
    <div class="table-wrap">
        <table class="table">
            <thead>
                <tr>
                    <th>N¬∞ Orden</th>
                    <th>Fecha</th>
                    <th>Proveedor</th>
                    <th>Productos</th>
                    <th>Subtotal</th>
                    <th>IGV</th>
                    <th>Total</th>
                    <th>Estado</th>
                    <th>Entrega Est.</th>
                    <th class="ta-right">Acciones</th>
                </tr>
            </thead>

            <tbody>
                @for (o of orders; track o.id) {
                <tr>
                    <td><a class="link-id" href="javascript:void(0)">{{ o.code }}</a></td>
                    <td>{{ o.fecha | date:'dd/MM/yyyy' }}</td>
                    <td>{{ o.proveedor }}</td>
                    <td>{{ o.items }} items</td>
                    <td>{{ o.subtotal | currency:'USD':'symbol':'1.0-2' }}</td>
                    <td>{{ o.igv | currency:'USD':'symbol':'1.0-2' }}</td>
                    <td class="bold">{{ o.total | currency:'USD':'symbol':'1.0-2' }}</td>
                    <td>
                        <span class="status" [class.pendiente]="o.estado==='Pendiente'"
                            [class.enviada]="o.estado==='Enviada'" [class.recibida]="o.estado==='Recibida'"
                            [class.cerrada]="o.estado==='Cerrada'" [class.retrasada]="o.estado==='Retrasada'">
                            {{ o.estado }}
                        </span>
                    </td>
                    <td>{{ o.entrega | date:'dd/MM/yyyy' }}</td>
                    <td class="actions ta-right">
                        <button class="icon-btn" title="Ver">üëÅÔ∏è</button>
                        <button class="icon-btn" title="Editar">‚úèÔ∏è</button>
                        <button class="icon-btn" title="Notas">üóíÔ∏è</button>
                        <button class="icon-btn" title="Auditar">üîé</button>
                    </td>
                </tr>
                }
            </tbody>
        </table>
    </div>


    <footer class="panel-foot">
        <button class="btn nav" [disabled]="page===1" (click)="prevPage()">‚Üê Anterior</button>

        <div class="page-info">
            P√°gina {{ page }} de {{ totalPages }} ({{ totalProducts }} productos)
        </div>

        <button class="btn nav primary" [disabled]="page===totalPages" (click)="nextPage()">Siguiente ‚Üí</button>
    </footer>
</section>

<div class="grid-side">
    <section class="panel">
        <!-- Columna izquierda: Reabastecer -->
        <h4>Productos por Reabastecer</h4>

        <div class="table-wrap">
            <table class="table">
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Stock</th>
                        <th>Min.</th>
                        <th>Sugerido</th>
                        <th>Proveedor</th>
                        <th class="ta-right">Acci√≥n</th>
                    </tr>
                </thead>
                <tbody>
                    @for (p of toReplenish; track p.code) {
                    <tr>
                        <td>{{ p.name }}</td>
                        <td [class.low]="p.stock < p.min" class="bold">{{ p.stock }}</td>
                        <td class="muted">{{ p.min }}</td>
                        <td class="bold">{{ p.suggested }}</td>
                        <td class="muted">{{ ' ' + p.supplier }}</td>
                        <td class="actions ta-right">
                            <button class="btn pill">+ Orden</button>
                        </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>
    </section>

    <section class="panel">
        <!-- Columna derecha: Gastos por Mes -->
        <aside class="mini-card">
            <h5>Gastos por Mes</h5>

            <div class="bars">
                @for (m of spendSeries; track m.label) {
                <div class="bar" [class.is-current]="m.current">
                    <div class="bar-col" [style.height.%]="m.percent"></div>
                    <small class="muted">{{ m.label }}</small>
                </div>
                }
            </div>

            <hr>

            <div class="stats">
                <div class="row">
                    <span class="muted">Promedio Mensual:</span>
                    <strong>{{ avgSpend | currency:'USD':'symbol':'1.0-0' }}</strong>
                </div>
                <div class="row">
                    <span class="muted">Mes Actual:</span>
                    <strong>{{ currentSpend | currency:'USD':'symbol':'1.0-0' }}</strong>
                </div>
                <div class="row">
                    <span class="muted">Variaci√≥n:</span>
                    <span class="chip">‚Üë {{ variationPct | percent:'1.1-1' }}</span>
                </div>
            </div>
        </aside>
    </section>
</div>